<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8" />
	<title>Arena - Combat Mechanics</title>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
	<script type="text/javascript" src="js/phaser.js"></script>
	<script type="text/javascript" src="Combat.js"></script>
	<script type="text/javascript" src="Player.js"></script>
	<script type="text/javascript" src="Bullet.js"></script>
	<script type="text/javascript" src="Enemy.js"></script>
	<script type="text/javascript" src="HealthBar.js"></script>
	<script type="text/javascript" src="Obstacle.js"></script>
	<script type="text/javascript" src="HealthPotion.js"></script>
	<script type="text/javascript">

	var combat;

	// --- Obstacles
	var obstaclesAmt = 3;
	var obstacles = [];
	var obstacleCollisionGroup; 	// The collision group for the walls
	// Positioning
	var obstaclesMinY = 250;
	var obstaclesMaxY = 500;
	// Size
	var obstaclesMinWidth = 3;
	var obstaclesMinHeight = 2;
	var obstaclesMaxWidth = 9;
	var obstaclesMaxHeight = 4;

	// --- Heath Potion
	var healthPotion; 		// The object
	var HPamt = 5;
	var HPheal = 25;
	var HPcooldown = 100;

	// --- Player
	var player; 			// The object
	var playerHP;			// Life bar object
	var playerYposition = 600;
	var playerHealthPoints = 100;
	var playerXvelocity = 240;
	var playerShootingCD = 50;
	var playerDashCD = 80;
	// The player Bullet
	var playerBulletType = "normal"; 	// This can assume the values: normal, fire, electric, acid, ice, or amor piercing  
	var playerBulletSpread = 1;			// 1, 2, 4, 6, or 8
	var playerBulletVelocity = -1200;
	var playerBulletDamage = 1;

	// --- Enemy
	var enemy = []; 		// The object
	var enemyHP;			// Life bar object
	var enemyAmt = 1;			// TODO
	var enemyHealthPoints = 12;
	var enemyMinYPosition = 100;
	var enemyMaxYPosition = 400;
	// The arrays refer to things that can change by the level of difficulty of the enemy
	var enemyLvlChange = [80, 20, 0]; 	// The level is activated if life is bigger than __%
	var enemyXvelocity = [120, 180, 240];
	var enemyShootingCD = [50, 80, 200];
	var enemyEvasion = [0, 1, 2]; 		// Refers to the level of evasion: 0: No evasion; 1: Dash; 2 - Dash + Defensive Movement
	var enemyDashCD = 200;
	// The enemy Bullet
	var enemyBulletDamage = 12;
	var enemyBulletVelocity = 1200;

	$(document).ready(function(){
		// Filling the text fields with default values

		// Obstacles
		$("#obstaclesAmt").val(obstaclesAmt);
		$("#obstaclesMinY").val(obstaclesMinY);
		$("#obstaclesMaxY").val(obstaclesMaxY);
		$("#obstaclesMinWidth").val(obstaclesMinWidth);
		$("#obstaclesMinHeight").val(obstaclesMinHeight);
		$("#obstaclesMaxWidth").val(obstaclesMaxWidth);
		$("#obstaclesMaxHeight").val(obstaclesMaxHeight);

		// Health Potions
		$("#HPamt").val(HPamt);
		$("#HPheal").val(HPheal);
		$("#HPcooldown").val(HPcooldown);

		// Player
		$("#playerYposition").val(playerYposition);
		$("#playerHealthPoints").val(playerHealthPoints);
		$("#playerXvelocity").val(playerXvelocity);
		$("#playerShootingCD").val(playerShootingCD);
		$("#playerDashCD").val(playerDashCD);
		//$("#playerBulletType").val(playerBulletType);
		//$("#playerBulletSpread").val(playerBulletSpread);
		$("#playerBulletVelocity").val(playerBulletVelocity);
		$("#playerBulletDamage").val(playerBulletDamage);

		// Enemy
		$("#enemyAmt").val(enemyAmt);
		$("#enemyHealthPoints").val(enemyHealthPoints);
		$("#enemyMinYPosition").val(enemyMinYPosition);
		$("#enemyMaxYPosition").val(enemyMaxYPosition);
		$(".enemyLvlChange0").val(enemyLvlChange[0]);
		$(".enemyLvlChange1").val(enemyLvlChange[1]);
		$(".enemyLvlChange2").val(enemyLvlChange[2]);

		$(".enemyXvelocity0").val(enemyXvelocity[0]);
		$(".enemyXvelocity1").val(enemyXvelocity[1]);
		$(".enemyXvelocity2").val(enemyXvelocity[2]);

		$(".enemyShootingCD0").val(enemyShootingCD[0]);
		$(".enemyShootingCD1").val(enemyShootingCD[1]);
		$(".enemyShootingCD2").val(enemyShootingCD[2]);

		$(".enemyEvasion0").val(enemyEvasion[0]);
		$(".enemyEvasion1").val(enemyEvasion[1]);
		$(".enemyEvasion2").val(enemyEvasion[2]);

		$("#enemyDashCD").val(enemyDashCD);
		$("#enemyBulletDamage").val(enemyBulletDamage);
		$("#enemyBulletVelocity").val(enemyBulletVelocity);

	
		// Listener to start the game
		$('#play').on('click',function() {
			//console.log("submit");
			// Set values
			obstaclesAmt = parseInt($("#obstaclesAmt").val());
			// Positioning
			obstaclesMinY = parseInt($("#obstaclesMinY").val());
			obstaclesMaxY = parseInt($("#obstaclesMaxY").val());
			// Size
			obstaclesMinWidth = parseInt($("#obstaclesMinWidth").val());
			obstaclesMinHeight = parseInt($("#obstaclesMinHeight").val());
			obstaclesMaxWidth = parseInt($("#obstaclesMaxWidth").val());
			obstaclesMaxHeight = parseInt($("#obstaclesMaxHeight").val());

			// --- Heath Potion
			healthPotion; 		// The object
			HPamt = parseInt($("#HPamt").val());
			HPheal = parseInt($("#HPheal").val());
			HPcooldown = parseInt($("#HPcooldown").val());

			// --- Player
			playerYposition = parseInt($("#playerYposition").val());
			playerHealthPoints = parseInt($("#playerHealthPoints").val());
			playerXvelocity = parseInt($("#playerXvelocity").val());
			playerShootingCD = parseInt($("#playerShootingCD").val());
			playerDashCD = parseInt($("#playerDashCD").val());
			// The player Bullet
			playerBulletType = $("#playerBulletType").val();	// This can assume the values: normal, fire, electric, acid, ice, or amor piercing  
			playerBulletSpread = $("#playerBulletSpread").val();			// 1, 2, 4, 6, or 8
			console.log(playerBulletSpread);
			playerBulletVelocity = parseInt($("#playerBulletVelocity").val());
			playerBulletDamage = parseInt($("#playerBulletDamage").val());

			// --- Enemy
			enemyAmt = parseInt($("#enemyAmt").val());			// TODO
			enemyHealthPoints = parseInt($("#enemyHealthPoints").val());
			enemyMinYPosition = parseInt($("#enemyMinYPosition").val());
			enemyMaxYPosition = parseInt($("#enemyMaxYPosition").val());
			// // The arrays refer to things that can change by the level of difficulty of the enemy
			enemyLvlChange =   [parseInt($(".enemyLvlChange0").val()), 
								parseInt($(".enemyLvlChange1").val()),
								parseInt($(".enemyLvlChange2").val())]; 	// The level is activated if life is bigger than __%
			enemyXvelocity =   [parseInt($(".enemyXvelocity0").val()),
								parseInt($(".enemyXvelocity1").val()),
								parseInt($(".enemyXvelocity2").val())];
			enemyShootingCD =  [parseInt($(".enemyShootingCD0").val()), 
								parseInt($(".enemyShootingCD1").val()), 
								parseInt($(".enemyShootingCD2").val())];
			enemyEvasion = [parseInt($(".enemyEvasion0").val()), 
							parseInt($(".enemyEvasion1").val()), 
							parseInt($(".enemyEvasion2").val())]; 		// Refers to the level of evasion: 0: No evasion; 1: Dash; 2 - Dash + Defensive Movement
			enemyDashCD = parseInt($("#enemyDashCD").val());
			// The enemy Bullet
			enemyBulletDamage = parseInt($("#enemyBulletDamage").val());
			enemyBulletVelocity = parseInt($("#enemyBulletVelocity").val());

			// Clean the form
			$("#form").empty();

			// Create the game
			game = new Phaser.Game(1280, 720, Phaser.AUTO, 'game', { preload: this.preload, create: this.create, update: this.update });
			// add the game state to the state manager
			game.state.add('combat', Combat);
			// and start the game
			game.state.start('combat');
		});
	});
	</script>
</head>
<body>
	<div id="game"></div>

	<div id="form">

			Obstacles: <br>
				Amount <input type="text" id="obstaclesAmt"><br>
				Positioning <br>
				Minimum Y <input type="text" id="obstaclesMinY"><br>
				Maximum Y <input type="text" id="obstaclesMaxY"><br>
				Size <br>
				Minimum Size <input type="text" id="obstaclesMinWidth"> x <input type="text" id="obstaclesMinHeight"><br>
				Maximum Size <input type="text" id="obstaclesMaxWidth"> x <input type="text" id="obstaclesMaxHeight"><br><br>

			Health Potions: <br>
				Amount <input type="text" id="HPamt"><br>
				Heal <input type="text" id="HPheal"><br>
				Cooldown <input type="text" id="HPcooldown"><br><br>

			Player: <br>
				Y position <input type="text" id="playerYposition"><br>
				Velocity <input type="text" id="playerXvelocity"><br> 
				Health Points <input type="text" id="playerHealthPoints"><br>
				Dash cooldown <input type="text" id="playerDashCD"><br>
				Shooting <br>
				Cooldown <input type="text" id="playerShootingCD"><br>
				Type <select id="playerBulletType">
							<option value="normal">normal</option>
							<option value="fire">fire</option>
							<option value="electric">electric</option>
							<option value="acid">acid</option>
							<option value="ice">ice</option>
							<option value="amor piercing">amor piercing</option>
						</select><br>
				Spread <select id="playerBulletSpread">
							<option value="1">1</option>
							<option value="2">2</option>
							<option value="4">4</option>
							<option value="6">6</option>
							<option value="8">8</option>
						</select><br>
				Velocity <input type="text" id="playerBulletVelocity"><br>
				Damage <input type="text" id="playerBulletDamage"><br><br>

			Enemy: <br>
				Amount <input type="text" id="enemyAmt"><br>
				Health Points <input type="text" id="enemyHealthPoints"><br>
				Positioning <br>
				Minimum Y <input type="text" id="enemyMinYPosition"><br>
				Maximum Y <input type="text" id="enemyMaxYPosition"><br>
				Per level
				Activate Level when life greater than __% <input type="text" class="enemyLvlChange0"><input type="text" class="enemyLvlChange1"><input type="text" class="enemyLvlChange2"><br>
				X Velocity <input type="text" class="enemyXvelocity0"><input type="text" class="enemyXvelocity1"><input type="text" class="enemyXvelocity2"><br>
				Shooting cooldown <input type="text" class="enemyShootingCD0"><input type="text" class="enemyShootingCD1"><input type="text" class="enemyShootingCD2"><br>
				Evasion <input type="text" class="enemyEvasion0"><input type="text" class="enemyEvasion1"><input type="text" class="enemyEvasion2"><br>
				Dash Cooldown <input type="text" id="enemyDashCD"><br>
				Bullet Damage <input type="text" id="enemyBulletDamage"><br>
				Bullet Velocity <input type="text" id="enemyBulletVelocity"><br>

				

			<button id="play">Play</button>

	</div>

</body>
</html>